{"version":3,"sources":["CurrentUserInfo.jsx","components/RequireLogin/RequireLogin.jsx","hooks.js","components/Login/Login.jsx","components/Register/Register.jsx","components/NewVote/img/1.png","components/NewVote/img/2.png","components/NewVote/NewVote.jsx","components/Vote/Vote.jsx","components/UploadAvatar/UploadAvatar.jsx","components/Mine/Mine.jsx","components/Main/Main.jsx","components/Home/Home.jsx","components/Background/Background.jsx","components/CheckBox_ios/CheckBox_ios.jsx","components/CreateVote/CreateVote.jsx","components/ViewVote/ViewVote.jsx","App.jsx","index.js"],"names":["UserContext","createContext","CurrentUserInfo","children","userInfo","useAxios","url","Provider","value","RequireLogin","history","useHistory","className","LeftOutlined","id","onClick","e","goBack","style","fontSize","src","alt","to","type","width","marginTop","FolderAddOutlined","cursor","MediumOutlined","UserOutlined","color","useInput","init","useState","setValue","onChange","useCallback","target","config","data","setData","error","setError","loading","setLoading","updata","setUpdata","useEffect","source","axios","CancelToken","token","then","res","code","result","msg","catch","toString","cancel","Updata","useUser","useContext","forceLogin","Comp","props","console","log","Login","name","password","captcha","a","info","toLocaleLowerCase","post","alert","push","window","location","reload","response","marginBottom","placeholder","prefix","UnlockOutlined","SafetyCertificateOutlined","marginLeft","height","Register","email","MailOutlined","NewVote","vote1","vote2","Vote","votes","map","it","voteId","title","multiple","anonymous","borderRadius","avatar","getBase64","img","callback","reader","FileReader","addEventListener","readAsDataURL","beforeUpload","file","isJpgOrPng","message","isLt2M","size","Avatar","state","handleChange","status","originFileObj","imageUrl","setState","this","uploadButton","backgroundColor","listType","showUploadList","action","React","Component","get","margin","Main","position","left","top","exact","HomeOutlined","path","component","Mine","Home","rel","href","Background","CheckBox_ios","htmlFor","options","setOptions","desc","checked","setChecked","useCheckBox","query","search","useLocation","useMemo","URLSearchParams","useQuery","deadline","useDate","voteinfo","createdvote","bordered","item","idx","MinusCircleOutlined","produce","op","splice","remove","val","setOption","PlusCircleOutlined","ViewVote","useParams","Update","userVotes","setUserVotes","option","Date","now","vote","getTime","optionId","wsUrl","protocol","replace","host","ws","WebSocket","onmessage","JSON","parse","close","groupedVotes","_","groupBy","uniqueUserCount","uniqBy","length","thisOptionVotes","voteOption","wordWrap","content","some","userId","display","toFixed","oneVote","dayjs","format","App","CreatVote","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.06b96251.chunk.js","sourcesContent":["import { createContext } from \"react\";\r\nimport { useAxios } from \"./hooks.js\";\r\n\r\nexport const UserContext = createContext()\r\n\r\nexport default function CurrentUserInfo({ children }) {\r\n\r\n  let userInfo = useAxios({ url: '/account/current-user' })\r\n\r\n\r\n  return (\r\n    <UserContext.Provider value={userInfo}>\r\n      {children}\r\n    </UserContext.Provider>\r\n  )\r\n}","import { LeftOutlined, FolderAddOutlined, MediumOutlined, UserOutlined } from '@ant-design/icons'\r\nimport { useHistory, NavLink } from 'react-router-dom'\r\nimport { Button } from 'antd';\r\nimport './RequireLogin.css'\r\n\r\nexport default function RequireLogin({ userInfo }) {\r\n  const history = useHistory()\r\n\r\n  function handleClick(e) {\r\n    history.goBack()\r\n  }\r\n  return (\r\n    <div className=\"login\">\r\n      <div className=\"main_container\">\r\n        <div className='mainHead'>\r\n          <LeftOutlined id='goback' onClick={handleClick} style={{ fontSize: '24px' }} />\r\n          Machine's Vote\r\n        </div>\r\n        <div className=\"requireLogin\">\r\n          <div className=\"pleaselogin\">\r\n            <img src=\"img/logo.jfif\" alt='please login' className='pleaselogin_img' />\r\n            <p className='p'>请登录Machine's vote</p>\r\n            <p className='p'>以保证各项功能可以正常的使用</p>\r\n            <NavLink to='/login'><Button type='primary' style={{ width: \"240px\", marginTop: '20px' }}>登录</Button></NavLink>\r\n          </div>\r\n        </div>\r\n        <div className='mainFooter'>\r\n          <NavLink to='/main/newvote' id='newvote'><FolderAddOutlined style={{ fontSize: '28px', cursor: 'pointer' }} /></NavLink>\r\n          <NavLink to='/main/vote' id=\"vote\"><MediumOutlined style={{ fontSize: '28px', cursor: 'pointer' }} /></NavLink>\r\n          <NavLink to='/main/mine' id=\"mine\"><UserOutlined style={{ fontSize: '28px', cursor: 'pointer', color: 'rgb(37, 109, 243)' }} /></NavLink>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}","import { useState, useCallback, useMemo, useEffect, useContext } from 'react'\r\nimport { useLocation } from 'react-router-dom'\r\nimport axios from 'axios'\r\nimport { UserContext } from './CurrentUserInfo'\r\nimport RequireLogin from './components/RequireLogin/RequireLogin'\r\n\r\nexport function useInput(init = '') {\r\n  const [value, setValue] = useState(init)\r\n  let onChange = useCallback(function onChange(e) {\r\n    setValue(e.target.value)\r\n  }, [])\r\n\r\n  return {\r\n    value, onChange\r\n  }\r\n}\r\n\r\nexport function useDate(init = '') {\r\n  const [value, setValue] = useState(init)\r\n  let onChange = useCallback(function onChange(e) {\r\n    setValue(e)\r\n  }, [])\r\n\r\n  return {\r\n    value, onChange\r\n  }\r\n}\r\n\r\nexport function useCheckBox(init = false) {\r\n  const [checked, setChecked] = useState(init);\r\n  let onChange = useCallback(function onChange(e) {\r\n\r\n    setChecked(e.target.checked)\r\n  }, [])\r\n\r\n  return {\r\n    checked, onChange\r\n  }\r\n}\r\n\r\nexport function useQuery() {\r\n  let search = useLocation().search\r\n  return useMemo(() => new URLSearchParams(search), [search])\r\n}\r\n\r\nexport function useAxios(config) {\r\n  const [data, setData] = useState()//用来存放请求的数据\r\n  const [error, setError] = useState(null)//用来存放错误的结果\r\n  const [loading, setLoading] = useState(true)//用来存放数据是否还在加载中\r\n  const [updata, setUpdata] = useState(0)//用来强制更新\r\n\r\n  useEffect(() => {\r\n    const CancelToken = axios.CancelToken;\r\n    const source = CancelToken.source(); //用于取消axios请求\r\n    const req = axios({\r\n      ...config,\r\n      CancelToken: source.token\r\n    })//根据传过来的config信息，发送axios请求\r\n    req.then(res => {\r\n      if (res.data.code === 0) {\r\n        setData(res.data.result)//成功拿到信息后，将其更新到状态中\r\n        setError(null)//成功拿到信息后,将错误状态设置为null\r\n      } else {\r\n        setError(res.data.msg)\r\n      }\r\n      setLoading(false) //收到回复后将loading更新为false\r\n    }).catch(e => {\r\n      setError(e.toString()) //发生网络错误时的处理方式\r\n      setLoading(false)\r\n    })\r\n\r\n    return () => {\r\n      source.cancel() //当组件被卸载时，取消还在发送中的axios请求，清除副作用\r\n    }\r\n  }, [config.url, updata])//只有当配置中的url发生改变时，或者需要强制更新时才会重新运行副作用函数\r\n\r\n  const Updata = useCallback(function Updata() {\r\n    setLoading(true)\r\n    setUpdata(updata => updata + 1)\r\n  }, [])//用于强制更新的函数，使用useCallback确保每次组件更新时，该函数不变\r\n\r\n  return {\r\n    data,\r\n    loading,\r\n    error,\r\n    Updata,\r\n  }\r\n}\r\n\r\n// 拿到当前登陆用户的业务hook\r\nexport function useUser() {\r\n  return useContext(UserContext)\r\n}\r\n\r\nexport function forceLogin(Comp) {//强制登录高阶组件\r\n  //接收一个组件为参数，将其包裹，并向其传递用户登录信息，若用户已登录则返回当前组件\r\n  //若用户还在登陆中则返回loading组件\r\n  //若用户未登录则返回强制登录界面\r\n  function ForceLoginComp(props) {\r\n    const userInfo = useUser()\r\n    if (userInfo.loading) {\r\n      return null\r\n    }\r\n    if (userInfo.error) {\r\n      console.log(userInfo);\r\n      return <RequireLogin userInfo={userInfo} />\r\n    }\r\n    return <Comp {...props} userInfo={userInfo} />\r\n  }\r\n\r\n  return ForceLoginComp\r\n}\r\n\r\n\r\n","import axios from 'axios'\r\nimport { Input, Button } from 'antd'\r\nimport { UserOutlined, UnlockOutlined, SafetyCertificateOutlined } from '@ant-design/icons'\r\nimport { useHistory, NavLink } from 'react-router-dom'\r\nimport { useInput } from '../../hooks'\r\n\r\nfunction Login() {\r\n  let name = useInput()\r\n  let password = useInput()\r\n  let captcha = useInput()\r\n  var history = useHistory()\r\n\r\n  async function login() {\r\n    let info = {\r\n      name: name.value,\r\n      password: password.value,\r\n      captcha: captcha.value.toLocaleLowerCase()\r\n    }\r\n    try {\r\n      let res = await axios.post('/account/login', info)\r\n      if (res.data.code === -1)\r\n        alert(res.data.msg);\r\n      else {\r\n        history.push('/main')\r\n        window.location.reload(true)\r\n      }\r\n    } catch (e) {\r\n      let data = e.response.data\r\n      alert(data.msg);\r\n    }\r\n  }\r\n\r\n  async function visiter() {\r\n    let info = {\r\n      name: 'visiter',\r\n      password: '1',\r\n      captcha: ''\r\n    }\r\n    let res\r\n    try {\r\n      res = await axios.post('/account/login', info)\r\n      history.push('/main')\r\n      window.location.reload(true)\r\n    } catch (e) {\r\n      let data = e.response.data\r\n      console.log(data.msg);\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className='login'>\r\n      <div className=\"login_card\">\r\n        <img src=\"img/logo.jfif\" alt='please login' className='pleaselogin_img' style={{ marginBottom: '40px' }} />\r\n        <div style={{ fontSize: '15px' }}>还没有账号？点击<NavLink to='/register'>注册</NavLink></div>\r\n        <div><br /><Input style={{ width: '260px' }} placeholder=\"用户名\" prefix={<UserOutlined />} type=\"text\" {...name} /></div>\r\n        <div><br /><Input style={{ width: '260px' }} placeholder=\"密码\" prefix={<UnlockOutlined />} type=\"password\" {...password} /></div>\r\n        <div>\r\n          <br />\r\n          <div className='captcha_container'>\r\n            <Input style={{ width: '160px' }} placeholder=\"验证码\" prefix={<SafetyCertificateOutlined />} type=\"text\" {...captcha} />\r\n            <img style={{ width: '95px', marginLeft: '5px', height: '30px' }} src='/account/captcha-img' alt=\"验证码\" />\r\n          </div>\r\n        </div>\r\n        <div style={{ marginTop: '30px', marginBottom: '15px' }}><Button style={{ width: '260px' }} type='primary' className='logbutton' onClick={login}>登录</Button></div>\r\n        <Button style={{ width: '260px' }} type='primary' className='logbutton' onClick={visiter}>游客账号登录</Button>\r\n      </div>\r\n    </div >\r\n  )\r\n}\r\n\r\nexport default Login","import axios from 'axios'\r\nimport { Input, Button } from 'antd'\r\nimport { UserOutlined, UnlockOutlined, MailOutlined, SafetyCertificateOutlined } from '@ant-design/icons'\r\nimport { useInput } from '../../hooks'\r\nimport { useHistory, NavLink } from 'react-router-dom'\r\n\r\nfunction Register() {\r\n  let name = useInput()\r\n  let password = useInput()\r\n  let email = useInput()\r\n  let captcha = useInput()\r\n  var history = useHistory()\r\n\r\n  async function register() {\r\n    let info = {\r\n      name: name.value,\r\n      password: password.value,\r\n      email: email.value,\r\n      captcha: captcha.value.toLocaleLowerCase()\r\n    }\r\n    let res\r\n    try {\r\n      res = await axios.post('/account/register', info)\r\n      if (res.data.code === -1)\r\n        alert(res.data.msg);\r\n      else {\r\n        history.push('/login')\r\n      }\r\n    } catch (e) {\r\n      let data = e.response.data\r\n      alert(data.msg);\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className='login'>\r\n      <div className=\"login_card\">\r\n        <img src=\"img/logo.jfif\" alt='please login' className='pleaselogin_img' style={{ marginBottom: '40px' }} />\r\n        <div style={{ fontSize: '15px' }}>已有账号？点击<NavLink to='/login'>登录</NavLink></div>\r\n        <div><br /><Input style={{ width: '260px' }} placeholder=\"用户名\" prefix={<UserOutlined />} type=\"text\" {...name} /></div>\r\n        <div><br /><Input style={{ width: '260px' }} placeholder=\"密码\" prefix={<UnlockOutlined />} type=\"password\" {...password} /></div>\r\n        <div><br /><Input style={{ width: '260px' }} placeholder=\"电子邮箱\" prefix={<MailOutlined />} type=\"text\" {...email} /></div>\r\n        <div>\r\n          <br />\r\n          <div className='captcha_container'>\r\n            <Input style={{ width: '160px' }} placeholder=\"验证码\" prefix={<SafetyCertificateOutlined />} type=\"text\" {...captcha} />\r\n            <img style={{ width: '95px', marginLeft: '5px', height: '30px' }} src=\"/account/captcha-img\" alt=\"验证码\" />\r\n          </div>\r\n        </div>\r\n        <div style={{ marginTop: '30px' }}><Button style={{ width: '260px' }} type='primary' className='logbutton' onClick={register}>注册</Button></div>\r\n      </div>\r\n    </div >\r\n  )\r\n}\r\n\r\nexport default Register","export default __webpack_public_path__ + \"static/media/1.c2f82d27.png\";","export default __webpack_public_path__ + \"static/media/2.b07f7509.png\";","// 选创建单选还是多选的界面\r\nimport { Link } from 'react-router-dom'\r\nimport { Button } from 'antd'\r\nimport 'antd/dist/antd.css'\r\nimport './NewVote.css'\r\nimport vote1 from './img/1.png'\r\nimport vote2 from './img/2.png'\r\nimport { Fragment } from 'react'\r\n\r\nexport default function NewVote() {\r\n\r\n  return (\r\n    <Fragment>\r\n      <div className=\"card\">\r\n        <Link to=\"/create-vote\">\r\n          <img className=\"card-img\" alt=\"单选\" src={vote1} />\r\n          <Button type='primary' style={{ width: \"240px\" }}>单选投票</Button>\r\n        </Link>\r\n      </div>\r\n      <div className=\"line\"></div>\r\n      <div className=\"card\">\r\n        <Link to=\"/create-vote?multiple=1\">\r\n          <img className=\"card-img\" alt=\"多选\" src={vote2} />\r\n          <Button type='primary' style={{ width: \"240px\" }}>多选投票</Button>\r\n        </Link>\r\n      </div>\r\n    </Fragment>\r\n  )\r\n}","import { useAxios } from '../../hooks'\r\nimport { useHistory } from 'react-router'\r\nimport './Vote.css'\r\nexport default function Vote() {\r\n  const { loading, data, error } = useAxios({ url: `/all-vote` })\r\n  const history = useHistory()\r\n  const votes = data ?? []\r\n  function viewvote(voteId) {\r\n    history.push(`/view-vote/${voteId}`)\r\n  }\r\n  if (loading) return (<div className='Vote'></div>)\r\n  if (error) {\r\n    alert(error)\r\n    return\r\n  }\r\n  return (\r\n    <div className='Vote'>\r\n      {\r\n        votes.map(it => {\r\n          return (\r\n            <div className='vote_card' onClick={() => { viewvote(it.voteId) }}>\r\n              <div className=\"vote_card_title\">{it.title}</div>\r\n              <div className=\"lalala\">\r\n                <span style={{ color: 'rgb(24, 144, 255)' }}>[{it.multiple ? '多选' : '单选'}]</span>&nbsp;\r\n                <span style={{ color: 'rgb(24, 144, 255)' }}>[{it.anonymous ? '匿名投票' : '公开投票'}]</span>\r\n              </div>\r\n              <div className=\"vote_card_end\">\r\n                <div className=\"vote_card_creater\">创建者：{it.name}</div>\r\n                <img style={{ width: '35px', height: '35px', borderRadius: '50%' }} src={it.avatar} alt=\"avatar\" />\r\n              </div>\r\n            </div>\r\n          )\r\n        })\r\n      }\r\n    </div>\r\n  )\r\n}","import { Upload, message } from 'antd';\r\nimport React from 'react';\r\n\r\nfunction getBase64(img, callback) {\r\n  const reader = new FileReader();\r\n  reader.addEventListener('load', () => callback(reader.result));\r\n  reader.readAsDataURL(img);\r\n}\r\n\r\nfunction beforeUpload(file) {\r\n  const isJpgOrPng = file.type === 'image/jpeg' || file.type === 'image/png';\r\n  if (!isJpgOrPng) {\r\n    message.error('You can only upload JPG/PNG file!');\r\n  }\r\n  const isLt2M = file.size / 1024 / 1024 < 2;\r\n  if (!isLt2M) {\r\n    message.error('Image must smaller than 2MB!');\r\n  }\r\n  return isJpgOrPng && isLt2M;\r\n}\r\n\r\nclass Avatar extends React.Component {\r\n  state = {\r\n    loading: false,\r\n  };\r\n\r\n  handleChange = info => {\r\n    if (info.file.status === 'uploading') {\r\n      this.setState({ loading: true });\r\n      return;\r\n    }\r\n    if (info.file.status === 'done') {\r\n      // Get this url from response in real world.\r\n      getBase64(info.file.originFileObj, imageUrl =>\r\n        this.setState({\r\n          imageUrl,\r\n          loading: false,\r\n        }),\r\n      );\r\n    }\r\n  };\r\n\r\n  render() {\r\n    const { loading, imageUrl } = this.state;\r\n    const uploadButton = (\r\n      <div>\r\n        {/* {loading ? <LoadingOutlined /> : <PlusOutlined />} */}\r\n        <img src={this.props.avatar} alt=\"avatar\" style={{ width: '110px', height: '110px', borderRadius: '50%' }} />\r\n      </div>\r\n    );\r\n    return (\r\n      <Upload\r\n        style={{ marginTop: 8, width: '120px', height: '120px', borderRadius: '50% !important', backgroundColor: 'yello' }}\r\n        name=\"avatar\"\r\n        listType=\"picture-card\"\r\n        className=\"avatar-uploader\"\r\n        showUploadList={false}\r\n        action=\"/upload\"\r\n        beforeUpload={beforeUpload}\r\n        onChange={this.handleChange}\r\n      >\r\n        {imageUrl ? <img src={imageUrl} alt=\"avatar\" style={{ width: '115px', height: '110px', borderRadius: '50%' }} /> : uploadButton}\r\n      </Upload>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Avatar","import axios from 'axios';\r\nimport { forceLogin } from '../../hooks'\r\nimport { Button } from 'antd';\r\nimport Avatar from '../UploadAvatar/UploadAvatar'\r\nimport './Mine.css'\r\n\r\nfunction Mine({ userInfo }) {\r\n  console.log(userInfo);\r\n  async function signup() {\r\n    try {\r\n      let res = await axios.get('/account/logout')\r\n      window.location.reload(true)\r\n    } catch (e) {\r\n      let data = e.response.data\r\n      console.log(data.msg);\r\n    }\r\n  }\r\n  return (\r\n    <div className='Mine_container'>\r\n      <div className=\"Mine\">\r\n        <Avatar style={{ width: '120px', height: '120px', margin: '0' }} avatar={userInfo.data.avatar} />\r\n        <span style={{ marginBottom: '20px', fontSize: '14px' }}>upload avatar</span>\r\n        <p>username: {userInfo.data.name}</p>\r\n        <p>email: {userInfo.data.email}</p>\r\n        <Button style={{ width: '260px' }} type='primary' className='logbutton' onClick={signup}>退出登录</Button>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default forceLogin(Mine)","import { Switch, Route, Redirect, NavLink } from 'react-router-dom'\r\nimport NewVote from '../NewVote/NewVote'\r\nimport { FolderAddOutlined, UserOutlined, HomeOutlined, MediumOutlined } from '@ant-design/icons'\r\nimport Vote from '../Vote/Vote'\r\nimport Mine from '../Mine/Mine'\r\nimport './Main.css'\r\n\r\nfunction Main() {\r\n  return (\r\n    <div className='login'>\r\n      <div className=\"main\">\r\n        <div className='mainHead'>\r\n          <img src=\"img/logo.jfif\" alt=\"\" className=\"logo2\" style={{ width: '55px', height: '55px', position: \"absolute\", left: \"-12px\", top: '-2px' }} />\r\n          Machine's Vote\r\n          <NavLink exact to='/' id='mainhome'><HomeOutlined style={{ fontSize: '28px' }} /></NavLink>\r\n        </div>\r\n        <div className=\"routers\">\r\n          <Switch>\r\n            <Route path=\"/main\" exact>\r\n              <Redirect to=\"/main/vote\" />\r\n            </Route>\r\n            <Route path='/main/vote' component={Vote} exact />\r\n            <Route path='/main/newvote' component={NewVote} />\r\n            <Route path='/main/mine' component={Mine} />\r\n          </Switch>\r\n        </div>\r\n        <div className='mainFooter'>\r\n          <NavLink to='/main/newvote' id='newvote'><FolderAddOutlined style={{ fontSize: '28px', cursor: 'pointer' }} /></NavLink>\r\n          <NavLink to='/main/vote' id=\"vote\"><MediumOutlined style={{ fontSize: '28px', cursor: 'pointer' }} /></NavLink>\r\n          <NavLink to='/main/mine' id=\"mine\"><UserOutlined style={{ fontSize: '28px', cursor: 'pointer' }} /></NavLink>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Main","import { Link, useHistory } from 'react-router-dom'\r\nimport axios from 'axios'\r\nfunction Home() {\r\n  const history = useHistory()\r\n  async function visiter() {\r\n    let info = {\r\n      name: 'visiter',\r\n      password: '1',\r\n      captcha: ''\r\n    }\r\n    try {\r\n      let res = await axios.post('/account/login', info)\r\n      history.push('/main')\r\n      window.location.reload(true)\r\n    } catch (e) {\r\n      let data = e.response.data\r\n      console.log(data.msg);\r\n    }\r\n  }\r\n\r\n  function toMain() {\r\n    history.push('/main')\r\n    return\r\n  }\r\n  return (\r\n    <div className=\"container\">\r\n      <div className='home'>\r\n        <div className=\"logo1\">\r\n          <img src=\"img/logo.jfif\" alt=\"\" className=\"logo2\" />\r\n        </div>\r\n        <p className=\"name\">Machine's Vote</p>\r\n\r\n        <div className=\"slogan\" id=\"slogan\" onClick={toMain}>\r\n          <p className=\"slogan2\" id=\"slogan2\">Voting!</p>\r\n        </div>\r\n        <div className=\"buttons\">\r\n          <Link className=\"button1\" to=\"/login\" >Login</Link>\r\n          <Link className=\"button1\" to=\"/register\">signUp</Link>\r\n          <Link className=\"button1\" onClick={visiter}>游客访问</Link>\r\n        </div>\r\n\r\n        <footer className=\"footer\">\r\n          <p className=\"footer2\">Welcome</p>\r\n\r\n          <p className=\"footer2\">&copy;2021 Machine &nbsp; 素材来源 <a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://image.baidu.com/search/index?tn=baiduimage&ct=201326592&lm=-1&cl=2&ie=gb18030&word=%C4%C7%D2%BB%C4%EA%CE%D2%C3%C7%B6%FE%CA%AE%C6%DF%B0%CB%CB%EA%CD%BC%C6%AC&fr=ala&ala=1&alatpl=normal&pos=0&dyTabStr=MCwzLDYsNCwxLDUsNyw4LDIsOQ%3D%3D\">那一年我们二十六七</a> &nbsp; 作者:Machine</p>\r\n        </footer>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Home","import { Fragment } from 'react'\r\n\r\nfunction Background() {\r\n  return (\r\n    <Fragment>\r\n      <div className=\"background\" id=\"background\"></div>\r\n      <div className=\"yinghua\" id=\"yinghua\"></div>\r\n      <div className=\"background2\" id=\"background2\"></div>\r\n    </Fragment>\r\n  )\r\n}\r\n\r\nexport default Background","import './CheckBox_ios.css'\r\n\r\nexport default function CheckBox_ios(props) {\r\n  return (\r\n    <div className='CheckBox_ios'>\r\n      <input type=\"checkbox\" onChange={props.onChange} name=\"ios-checkbox\" className='ios' id={props.id} />\r\n      <label className='ios' htmlFor={props.id}>\r\n        <div className='ios'></div>\r\n      </label>\r\n    </div>\r\n  )\r\n}","import { DatePicker, Button, Input } from 'antd';\r\nimport { LeftOutlined, MinusCircleOutlined, PlusCircleOutlined } from '@ant-design/icons'\r\nimport { NavLink, useHistory } from 'react-router-dom';\r\nimport { produce } from 'immer'\r\nimport { useState } from 'react';\r\nimport axios from 'axios'\r\nimport { useCheckBox, useInput, useQuery, useDate, forceLogin } from '../../hooks';\r\nimport CheckBox_ios from '../CheckBox_ios/CheckBox_ios';\r\nimport './CreateVote.css'\r\nfunction CreatVote() {\r\n  const [options, setOptions] = useState(['', ''])\r\n  const title = useInput()\r\n  const desc = useInput()\r\n  const anonymous = useCheckBox()\r\n  const history = useHistory()\r\n  const query = useQuery()\r\n  const deadline = useDate()\r\n\r\n  function remove(idx) {\r\n    setOptions(produce(options, (op) => {\r\n      op.splice(idx, 1)\r\n    }))\r\n  }\r\n\r\n  function setOption(idx, val) {\r\n    setOptions(produce(options, (op) => {\r\n      op[idx] = val\r\n    }))\r\n  }\r\n\r\n  function addOption() {\r\n    setOptions(produce(options, (op) => {\r\n      op.push('')\r\n    }))\r\n  }\r\n\r\n  async function create() {\r\n    const voteinfo = {\r\n      title: title.value,\r\n      desc: desc.value,\r\n      options: options,\r\n      deadline: deadline.value,\r\n      anonymous: anonymous.checked,\r\n      multiple: query.get('multiple') === '1' ? true : false\r\n    }\r\n\r\n    console.log(voteinfo);\r\n    try {\r\n      let res = await axios.post('/vote', voteinfo)\r\n      let createdvote = res.data.result\r\n      console.log(createdvote);\r\n      history.push('/main/vote')\r\n      window.location.reload(true)\r\n    } catch (e) {\r\n      throw (e)\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className=\"login\">\r\n      <div className=\"main_container\">\r\n        <div className='mainHead'>\r\n          <NavLink exact to='/main/newvote' id='tonewvote'><LeftOutlined style={{ fontSize: '24px' }} /></NavLink>\r\n          Machine's Vote\r\n        </div>\r\n        <div className=\"options\">\r\n          <div className=\"votetitle\"><Input {...title} style={{ fontSize: '26px', height: '60px' }} bordered={false} type=\"text\" placeholder='投票标题' /></div>\r\n          <div className=\"votetitle\"><Input {...desc} style={{ fontSize: '20px', height: '50px' }} bordered={false} type=\"text\" placeholder='补充描述' /></div>\r\n          {\r\n            options.map((item, idx) => {\r\n              return <div key={idx} className=\"option\"><MinusCircleOutlined onClick={(e) => remove(idx)} className='jian' /><Input onChange={(e) => setOption(idx, e.target.value)} value={item} style={{}} bordered={false} type=\"text\" placeholder='选项' /></div>\r\n            })\r\n          }\r\n          <div onClick={addOption} className=\"tianjia\"><PlusCircleOutlined className='jia' /><span style={{ marginLeft: \"10px\" }}>添加选项</span></div>\r\n        </div>\r\n        <div className='line' style={{ height: '30px' }}></div>\r\n        <div className=\"others\">\r\n          <div className=\"other\">\r\n            <div className='CreateVote_text'>截止日期</div>\r\n            <DatePicker\r\n              {...deadline}\r\n              style={{ cursor: \"pointer\" }}\r\n              bordered={false}\r\n            />\r\n          </div>\r\n          <div className=\"other\"><div className='CreateVote_text'>匿名投票</div><CheckBox_ios {...anonymous} id='ios1' /></div>\r\n          <div className=\"other\"><div className='CreateVote_text'>限制传播</div><CheckBox_ios id='ios2' /></div>\r\n        </div>\r\n        <Button onClick={create} type='primary' style={{ width: \"350px\", marginTop: '30px' }}>发布投票</Button>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default forceLogin(CreatVote)","import { LeftOutlined } from \"@ant-design/icons\"\r\nimport { useState, useEffect, useMemo } from \"react\"\r\nimport { NavLink, useParams, useHistory } from \"react-router-dom\"\r\nimport { useAxios, useUser } from \"../../hooks\"\r\nimport axios from \"axios\"\r\nimport _ from 'lodash'\r\nimport dayjs from \"dayjs\"\r\nimport './ViewVote.css'\r\n\r\nexport default function ViewVote() {\r\n  const { voteId } = useParams()\r\n  const { loading, data, error, Update } = useAxios({ url: `/vote/${voteId}` })\r\n  const [userVotes, setUserVotes] = useState() // 从websocket上获取到的实时信息\r\n  const userInfo = useUser()\r\n  const history = useHistory()\r\n  console.log(userInfo);\r\n  useEffect(() => { //这里的useEffect是为了在页面加载完成后，与服务器建立websocket链接，用于实时获取投票信息\r\n    if (loading || Date.now() > new Date(data.vote.deadline).getTime()) {\r\n      return    // 如果还在加载，或者是超过截止时间，则什么也不做\r\n    }\r\n    const wsUrl = `${window.location.protocol.replace('http', 'ws')}//${window.location.host}/realtime-voteinfo/${voteId}`\r\n    // var wsUrl = `ws://localhost:8081/realtime-voteinfo/${voteId}`\r\n    const ws = new WebSocket(wsUrl)\r\n    // 服务器发来的就是当前投票的最新投票信息\r\n    ws.onmessage = function (e) {\r\n      var data = JSON.parse(e.data)\r\n      console.log('从websocket获取到的实时投票信息', data)\r\n      setUserVotes(data)\r\n    }\r\n\r\n    return () => ws.close() //当组件卸载时，断开ws链接\r\n  }, [loading, voteId])//只有当loading改变或者是投票id改变时副作用函数才会重新运行\r\n\r\n  // 为某个选项投票/或取消投票\r\n  async function voteOption(option) {\r\n    if (userInfo.error) {\r\n      history.push('/main/mine')\r\n      return\r\n    }\r\n    if (Date.now() > new Date(data.vote.deadline).getTime()) {\r\n      alert('该投票已截止，无法继续投票')\r\n      return\r\n    }\r\n    var { optionId } = option\r\n    await axios.post(`/vote/${voteId}`, {\r\n      optionId: optionId\r\n    })\r\n  }\r\n\r\n  const votes = userVotes ?? data?.userVotes ?? []\r\n  // ?? 当左边的值为undefined或者null时，取右边的值，否则取左边的值\r\n  // ?  当左边的值为undefined或null时，取值为左边的值，并且不报错，否则取其属性的值\r\n\r\n  //我们从后端拿到的数据包含了userVote这个对象\r\n  const groupedVotes = useMemo(() => _.groupBy(votes, 'optionId'), [votes])\r\n  const uniqueUserCount = useMemo(() => _.uniqBy(votes, 'userId').length, [votes]) // 去重后用户数量\r\n  console.log(uniqueUserCount);\r\n  // console.log('分组后的投票数据', groupedVotes)\r\n  // console.log('去重后的投票人数', uniqueUserCount)\r\n  if (loading) return (\r\n    <div className=\"login\">\r\n      <div className=\"main_container\">\r\n        <div className='mainHead'>\r\n          <NavLink exact to='/main/vote' id='tonewvote'><LeftOutlined style={{ fontSize: '24px' }} /></NavLink>\r\n          Machine's Vote\r\n        </div>\r\n        <div className=\"vote_footer\"></div>\r\n      </div>\r\n    </div>\r\n  )\r\n\r\n  return (\r\n    <div className=\"login\">\r\n      <div className=\"main_container\">\r\n        <div className='mainHead'>\r\n          <NavLink exact to='/main/vote' id='tonewvote'><LeftOutlined style={{ fontSize: '24px' }} /></NavLink>\r\n          Machine's Vote\r\n        </div>\r\n        <div className=\"title_container\">\r\n          <div className=\"bigtitle\">{data.vote.title}</div>\r\n          <div className=\"detail\">{data.vote.desc}</div>\r\n          <div className=\"other_info\">\r\n            <span style={{ color: 'rgb(24, 144, 255)' }}>[{data.vote.multiple ? '多选' : '单选'}]</span>&nbsp;\r\n            <span style={{ color: 'rgb(24, 144, 255)' }}>[{data.vote.anonymous ? '匿名投票' : '公开投票'}]</span>\r\n          </div>\r\n        </div>\r\n        <div className=\"options_container\">\r\n          {\r\n            data.options.map(option => {\r\n              // option 是选项本身\r\n              // 当前选项的票数信息\r\n              var thisOptionVotes = groupedVotes[option.optionId] || []\r\n              return (\r\n                <div className=\"option_container\" key={option.optionId}>\r\n                  <div className=\"option_title\" style={{ cursor: 'pointer' }} onClick={() => voteOption(option)}>\r\n                    <div className=\"option_title_main\"><span style={{ width: '250px', wordWrap: 'break-word' }}>{option.content}{userInfo.data ? (thisOptionVotes.some(it => it.userId === userInfo.data.userId) ? '✔️' : '') : ''}</span><div style={{ fontSize: '13px', display: 'flex' }}><span className='spanleft'>{thisOptionVotes.length}票</span><span className='spanright'>{uniqueUserCount === 0 ? 0 : (thisOptionVotes.length / uniqueUserCount * 100).toFixed(1)}%</span></div></div>\r\n                    <div className=\"option_title_percent\" style={{ width: `${uniqueUserCount === 0 ? 0 : (thisOptionVotes.length / uniqueUserCount * 100) * 3.6}px` }}></div>\r\n\r\n                  </div>\r\n                  <div className=\"option_userImg\">\r\n                    {\r\n                      thisOptionVotes.map(oneVote => {\r\n                        return <img key={oneVote.userId} className=\"user-img\" src={oneVote.avatar} />\r\n                      })\r\n                    }\r\n                  </div>\r\n                </div>\r\n              )\r\n            })\r\n          }\r\n        </div>\r\n        <div className=\"vote_deadline\">投票截至：{dayjs(data.vote.deadline).format('YYYY-MM-DD HH:mm')}</div>\r\n        <div className=\"vote_footer\"></div>\r\n      </div>\r\n    </div>\r\n  )\r\n}","\r\nimport { Switch, Route, HashRouter } from 'react-router-dom'\r\nimport Login from './components/Login/Login'\r\nimport Register from './components/Register/Register'\r\nimport Main from './components/Main/Main'\r\nimport RequireLogin from './components/RequireLogin/RequireLogin'\r\nimport Home from './components/Home/Home'\r\nimport Background from './components/Background/Background'\r\nimport CreatVote from './components/CreateVote/CreateVote'\r\nimport ViewVote from './components/ViewVote/ViewVote'\r\nimport CurrentUserInfo from './CurrentUserInfo'\r\n\r\nexport default function App() {\r\n  return (\r\n    <CurrentUserInfo>\r\n      <HashRouter>\r\n        <div className='App'>\r\n          <Switch>\r\n            <Route path='/' component={Home} exact />\r\n            <Route path='/login' component={Login} />\r\n            <Route path='/register' component={Register} />\r\n            <Route path='/main' component={Main} />\r\n            <Route path='/create-vote' component={CreatVote} />\r\n            <Route path=\"/view-vote/:voteId\" component={ViewVote} />\r\n            <Route path='/requirelogin' component={RequireLogin} />\r\n          </Switch>\r\n          <Background />\r\n        </div>\r\n      </HashRouter>\r\n    </CurrentUserInfo>\r\n  )\r\n}\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\n\r\nimport App from './App';\r\n\r\nReactDOM.render(<React.StrictMode>\r\n  <App />\r\n</React.StrictMode>, document.getElementById('root'))"],"sourceRoot":""}